/******************************************
 * @name 绳师𝐒𝐌
 * @description 解锁会员视频
 * @channel https://t.me/yqc_123
 * @feedback https://t.me/yqc_777
 * @version 1.0.2
******************************************

## 脚本注明

1. 脚本只是针对基于 Quantumult X 和 Surge 对 Javascript 和 WEB 逆向的学习，不得用于商业用途，否则后果自负。
2. 不保证脚本合法性、准确性、有效性，请根据情况自行判断，本人对此不承担任何保证责任。
3. 本人对任何脚本引发的问题概不负责，包括但不限于由脚本错误引起的任何损失和损害。
4. 转载脚本请注明来源，欢迎分享，拒绝倒卖，倒卖 🐕 必死 🐎。
5. 如果任何单位或个人认为此脚本可能涉嫌侵犯其权利，应及时通知并提供身份证明，所有权证明，我们将在收到认证文件确认后删除此脚本。
6. 所有直接或间接使用、查看此脚本的人均应该仔细阅读此声明, 本人保留随时更改或补充此声明的权利, 一旦您使用或复制了此脚本，即视为您已接受此免责声明。
7. 欢迎对[本仓库](https://github.com/Yuheng0101/X)Star✅，但请不要 Fork❌。

[绳师SM](https://syz.xn--fiq2km75ifcu.com/sssm.html?v=xboY40kLeg)

## 致谢

[@苍井灰灰](https://t.me/wangfei021325)

******************************************
hostname = *.sssm.info,*.cloudfront.net,*.ddosapi.cyou
# 解锁
^https?:\/\/.*(sssm|cloudfront|ddosapi).+\/api(\/v1|)\/videos(\/\w+|)\/show url script-request-header https://raw.githubusercontent.com/Yuheng0101/X/main/Scripts/sssm.js
# 个人中心
^https?:\/\/.*(sssm|cloudfront|ddosapi).+\/api(\/v1|)\/(banners|users\/get_profile) url script-response-body https://raw.githubusercontent.com/Yuheng0101/X/main/Scripts/sssm.js

*/
const $ = new Env('𝐒𝐒𝐒𝐌')
var _0xodE='jsjiami.com.v7';const _0x5cb350=_0x22b4;(function(_0x3ff1e0,_0x37dbb1,_0x36d18d,_0x370b0b,_0x3241fa,_0x1ff19d,_0xa4c782){return _0x3ff1e0=_0x3ff1e0>>0x6,_0x1ff19d='hs',_0xa4c782='hs',function(_0x55c908,_0x53b6f1,_0x1d384a,_0x5a9794,_0x4079c2){const _0x46278e=_0x22b4;_0x5a9794='tfi',_0x1ff19d=_0x5a9794+_0x1ff19d,_0x4079c2='up',_0xa4c782+=_0x4079c2,_0x1ff19d=_0x1d384a(_0x1ff19d),_0xa4c782=_0x1d384a(_0xa4c782),_0x1d384a=0x0;const _0xb4aedf=_0x55c908();while(!![]&&--_0x370b0b+_0x53b6f1){try{_0x5a9794=parseInt(_0x46278e(0x203,'efT)'))/0x1+parseInt(_0x46278e(0x19e,'4agN'))/0x2+-parseInt(_0x46278e(0x1de,'ZSNr'))/0x3+-parseInt(_0x46278e(0x244,'HQlP'))/0x4+parseInt(_0x46278e(0x1e3,'pg3O'))/0x5+-parseInt(_0x46278e(0x23b,'QJhm'))/0x6*(-parseInt(_0x46278e(0x1a7,'TqNj'))/0x7)+-parseInt(_0x46278e(0x1d8,'^JHG'))/0x8*(parseInt(_0x46278e(0x1a2,'O^Y7'))/0x9);}catch(_0x584a22){_0x5a9794=_0x1d384a;}finally{_0x4079c2=_0xb4aedf[_0x1ff19d]();if(_0x3ff1e0<=_0x370b0b)_0x1d384a?_0x3241fa?_0x5a9794=_0x4079c2:_0x3241fa=_0x4079c2:_0x1d384a=_0x4079c2;else{if(_0x1d384a==_0x3241fa['replace'](/[TkSBtyxlFVGeYWpHOwE=]/g,'')){if(_0x5a9794===_0x53b6f1){_0xb4aedf['un'+_0x1ff19d](_0x4079c2);break;}_0xb4aedf[_0xa4c782](_0x4079c2);}}}}}(_0x36d18d,_0x37dbb1,function(_0x160d0e,_0x9f6e70,_0x54ca97,_0x34f06a,_0x171097,_0x38f6a7,_0x120727){return _0x9f6e70='\x73\x70\x6c\x69\x74',_0x160d0e=arguments[0x0],_0x160d0e=_0x160d0e[_0x9f6e70](''),_0x54ca97='\x72\x65\x76\x65\x72\x73\x65',_0x160d0e=_0x160d0e[_0x54ca97]('\x76'),_0x34f06a='\x6a\x6f\x69\x6e',(0x158d9a,_0x160d0e[_0x34f06a](''));});}(0x2f40,0x5f053,_0x2bab,0xbf),_0x2bab)&&(_0xodE=_0x5cb350(0x22a,'9g@T'));function _0x22b4(_0x42cd47,_0x46e53f){const _0x2bab23=_0x2bab();return _0x22b4=function(_0x22b420,_0x45e090){_0x22b420=_0x22b420-0x19a;let _0x1bed9f=_0x2bab23[_0x22b420];if(_0x22b4['QDmPwi']===undefined){var _0x312cd8=function(_0x393819){const _0xa78e0d='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let _0x5d406a='',_0x5c8d06='';for(let _0x359e60=0x0,_0x21c512,_0x59132b,_0x308b76=0x0;_0x59132b=_0x393819['charAt'](_0x308b76++);~_0x59132b&&(_0x21c512=_0x359e60%0x4?_0x21c512*0x40+_0x59132b:_0x59132b,_0x359e60++%0x4)?_0x5d406a+=String['fromCharCode'](0xff&_0x21c512>>(-0x2*_0x359e60&0x6)):0x0){_0x59132b=_0xa78e0d['indexOf'](_0x59132b);}for(let _0x5218e8=0x0,_0x467eca=_0x5d406a['length'];_0x5218e8<_0x467eca;_0x5218e8++){_0x5c8d06+='%'+('00'+_0x5d406a['charCodeAt'](_0x5218e8)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(_0x5c8d06);};const _0x247b79=function(_0x56269e,_0x2b2db2){let _0x2c3cef=[],_0x42e79c=0x0,_0x55ca59,_0x2d5414='';_0x56269e=_0x312cd8(_0x56269e);let _0x4f8855;for(_0x4f8855=0x0;_0x4f8855<0x100;_0x4f8855++){_0x2c3cef[_0x4f8855]=_0x4f8855;}for(_0x4f8855=0x0;_0x4f8855<0x100;_0x4f8855++){_0x42e79c=(_0x42e79c+_0x2c3cef[_0x4f8855]+_0x2b2db2['charCodeAt'](_0x4f8855%_0x2b2db2['length']))%0x100,_0x55ca59=_0x2c3cef[_0x4f8855],_0x2c3cef[_0x4f8855]=_0x2c3cef[_0x42e79c],_0x2c3cef[_0x42e79c]=_0x55ca59;}_0x4f8855=0x0,_0x42e79c=0x0;for(let _0x471f16=0x0;_0x471f16<_0x56269e['length'];_0x471f16++){_0x4f8855=(_0x4f8855+0x1)%0x100,_0x42e79c=(_0x42e79c+_0x2c3cef[_0x4f8855])%0x100,_0x55ca59=_0x2c3cef[_0x4f8855],_0x2c3cef[_0x4f8855]=_0x2c3cef[_0x42e79c],_0x2c3cef[_0x42e79c]=_0x55ca59,_0x2d5414+=String['fromCharCode'](_0x56269e['charCodeAt'](_0x471f16)^_0x2c3cef[(_0x2c3cef[_0x4f8855]+_0x2c3cef[_0x42e79c])%0x100]);}return _0x2d5414;};_0x22b4['qimuVI']=_0x247b79,_0x42cd47=arguments,_0x22b4['QDmPwi']=!![];}const _0x320d1c=_0x2bab23[0x0],_0x5e2e28=_0x22b420+_0x320d1c,_0x35cbc4=_0x42cd47[_0x5e2e28];return!_0x35cbc4?(_0x22b4['lCfKBE']===undefined&&(_0x22b4['lCfKBE']=!![]),_0x1bed9f=_0x22b4['qimuVI'](_0x1bed9f,_0x45e090),_0x42cd47[_0x5e2e28]=_0x1bed9f):_0x1bed9f=_0x35cbc4,_0x1bed9f;},_0x22b4(_0x42cd47,_0x46e53f);}function _0x2bab(){const _0x3f6461=(function(){return[_0xodE,'yTjpxVsltjeiEeawmBEi.coStmY.GHkv7WEwOeFB==','DI9xWObf','WPpdRfSgW5xcGSo0cgW','W7JdKCoNW67cPG','hxxcK8kWW54','W73cKmk1wdW','gcZcSCoFWPC2u8oOnSkczwv3W7K','W43dPSo/W7PI','zmopWRhcJSoP','WRnsWO7dTK4','wCkTwazo','WQunWRlcGcGJ','aqtdKW0','WOxcPKWSuq','W4tcPSk7Fa','kY3dTsJcQq','WP15Fbax','5P2b5yM85P2A5A67546i','mSk/W7VcQG','8kg5V/glQOdXGlMY8jo7OpcOI4lWN5MJ','m8kWW6ZcUuqQrdaFqmos','5Ro25lUh5lYw5zkr','xCoMFtmMfq','WO0ArW5KW65OW4aDW7xcTa','WR7dO37cUSoq','WQddKCkyarZdPColW7VdRJaGW4xcPdH6W5jRWRdcSNG','cCocgmkR','W5ddT8oOW79qWPDxF08tcatdImktnqxdOSouW4xcHYOksSo0WRXLWR0','xSkgxq','W4FdRwRdImkz','bbxdLWdcSCkZumolW750axBcN8koiwq','WRe/W6HQDa','WRRcHSoEuqBcOmo/W4JdQb8rWPu','hIfAW7ye','rmo0udyQ','WP15wbCtW4pcUa','WODZWQJdKhy','W5XmbvG','eqRdTbJcQG','WRKtW6HLBaz3nmkzWPtdRmouW4ddPCoXySkgkmkhW4KQWP7cLNlcHY1RWOJcKmo8WQ7dIX/cQINdOSk2g8kAW6lcS8kvkIlcRSkeWRVdJYtdT1PgW4VdTxNcJSoeWOSWW6mOAYhdMd3cVYuEWPFcSCkAcK5RFg/dJcmFW5aaW6ulsNdcRmoOWPxcRmkbjwj5WPNdMSoADg/cOmoQwSkoWRNdNGSRW5hdRvuNWPrUgSoavtVdV8kPBrmqW4ldGmoRBWjf','WP1ZW5nY','8koORpgfU4FWTjUo8yYBQFcQUyBWO7Iq','W4JdJ8oxW4X3','aSoinCkiiq','qmkDBCkO54Is5P6B5lIO5y+k5PEZ5O6d','WQtcNeuQsrxcL8kx','mCoEEbxdTW','wWFcRtJdOW','W5fdbvW7W7LDW70','WPPIqrStWP7dSvyv','WPbTwJxcUqKfs03cHmkcmG','W73dOSkrjMO','WQXgBcpdJSoaFeNcHa','W6SBlutcLCkDphBcHhVcUM/cNG','W4xdPMNdQXe','FCk7vq','WOazW6f4','nh0rWQjShaZcMSkS','W4HcaK0','WOxdO3VcGmow','W5lcU8kZ','zmkkW4nkmW','W6ddGaW9DYpcJCkRWQq'].concat((function(){return['W6OQpCoG','W78xW6ybWRG','h8ohagaYoCk2W4VcHmo6FxO','W5PzfKa6','WQGFWPNcLW','y8kuW6RdM8kPWPJdKXmeWO/cNSo1mcu','57+05ysO6lEP5PE6','W5ldJwJdRa4','hJdcVmoZWOqP','WRO8WRdcO8o+','WP/dL07cQ8os','aMBdGmorW47cSSoqmJqoW4npemkWWRWB','W4xdSmo6W4JcGa','W4jkWPtdGq','iqddVqBcQG','57+W5ywF6zE+6k+R','bmohBJFdGW','FHP1WPDW','F8ocWRddKCkN','BmkMv8kD','WObMW4X+pSkmWOtcNGe','WQ8rWONcKW','WOK9WPFcKdu','C8knW7H0','WObqrZew','W5SJcJO3WRBdSMK1','WQ45gmktW58','W7VdICkydqNcTG','WR5oAb0','mW7dSJJcRa','WR3dVvRcLq','W49ieW','6k+N5RoI6lwF5PsD','lsP4W4WrW6JdQXVdLa','cLRdOmo5W40','bSkMfHqdb8oXW6VdJa','EmkOs8klpW','W49pWPfnWR8','W7/dN8kBha','WR/dQsVcG3G','WPddM043W7e','WPvfW7Xaeq','W4Hma0O5','httcMmoHWR4','W7RdRSoQW61f','WQtdVCketCoi','WQCFWPRcHCoM','WQX0WRNdLhbbW4PxpabJWQhcM8ktg8kzWRBcVhpdNM1Co8kNgSkTW4VcRmkjimkcFSkek8ogW7tdTWNcO8o/hSoEqmkyWQPNWRRcIYiPWOb3pq4Cy8o/qsZcPCoJovFdHSk/WR7dU1y6j0TdW6e8ALO6kxHWWOhcLH/cIHX3W5/cLmoVWP7cU8o6W4FdTZL3vCkFW5NcOe8','WOHvWRvDW7JcUSo5px3dIGO8','hSozbmkNg8ory8oAvq','WRboWONdLM0','W4HaW67dGSkoCW','WR4qW4bzBW','omk4a1e','WONcSSkVWR4wWPTjp2G9kqxdGa','W4G/fW3dQK0','t8kvrti','W63dHmkpevu','fSoFCdxdHmoYhSk7W7JdMZS','WPizW5C1W6ftxmoeWOBdMSk3WPlcHW','W5nzWOW','WQbHWRNdHq','WPaQWRhcVSou','hKtcPmkZW6i'].concat((function(){return['eSkkW4RcJu8','WO4BWOZcHcqHWO0','W7pcH8k1vsG','thFdGmouWOJcOSoundqeW55wvCkNWRywWQlcNSoRW5a','umo0vIq','AmkoWOyS','W5FcPSkSBq','W5tdHwRdGb81WPOB','WQBcNfyEwbJcLa','W7BdSGD3WR/dIvBdJ0COyW','WR7dSIZcHhiKcSkeCG','eWZdLZpcVCk+vColW752cG','BSkaWPy0','ptfTW7yIW7NdTbpdNCoW','wmoWtci7dq','WQvDW5xcM1aVW70h','WQPoBG/dHW','5P+a5yIV5lUw5y+x55Aq','WRDPWQRdIG','u8kbd2VcHSkHxCkxW4NdOXpdUg8','WOSzfSksW6tcLX8V','WPmwWRpcLq','W5VcGmksgG','WRlcLxlcOSooA8obWP3dICoc','W43dLfddTW','W4e6gg0','WO0vfmkDW6/cHae','WPVcUflcRSoxW6lcOmo1FeNdMCoV','W6BdLY7dVSk8lSkzW53cNCkj','W45JWOJdQu4','uSocybio','W4FdVZNdRSku','W5ajW6m','WPldUuClW5tcIa','e3NdG8oj','D2nLW6aAWRFcVq','WQZdTI7cGxuGaSkwySoEbKaSW63dU8od','gHtcNCo3WPW','W5xcKSkmeSolW7/dN8oUWOefzmo1WOi2','d8o5o8k8aa','W6ddP8orW5PN','WRpcHKyCwGi','WQ1HWQNdO1y','W5ZdI1pdR8kuW77dHSofW7DEW7WIyYijFG','WQ7dGK0PW4K','BmkyA8kvpG','jmkPbfvlaCoaWRSTW7JcMmkmWPXKW4fpi8ogfaf4W4q','xCkDqqXKyCkMW6JcUSohwq','W73dGmoGW4BcSq','WOtdUv0o','WQZdPfFcJSkc','FCkeybbx','b3FdHmoC','W5rKWQNdPgG','DdxcGda','fIRcOSo9WPu','WOyraCkAW6i','nJBdTIdcNG','W4WjW7CA','tmktWQSGWQm','W6WXnmo8W6W'];}()));}()));}());_0x2bab=function(){return _0x3f6461;};return _0x2bab();};const debug=![],server=_0x5cb350(0x23f,'ZSNr'),[domain,host]=$request?.[_0x5cb350(0x1a0,'FM2#')]?.['match'](/^(?:https?:\/\/)?([^\/\s]+)/)||[_0x5cb350(0x216,'AzPf'),_0x5cb350(0x1ad,'OGSp')],statusMessages={0x190:'请求参数错误',0x191:'未授权，请登录',0x193:'跨域拒绝访问',0x198:_0x5cb350(0x1c8,'OGSp'),0x1f4:'服务器内部错误',0x1f5:_0x5cb350(0x235,'AzPf'),0x1f6:_0x5cb350(0x1b7,'pg3O'),0x1f7:_0x5cb350(0x1f9,'3GnO'),0x1f8:_0x5cb350(0x1ae,'Lv)M'),0x1f9:_0x5cb350(0x250,'FM2#')},ModifyReq=async()=>{const _0xf13379=_0x5cb350,_0x2d4676={'rOIDA':function(_0x122c06,_0xd25c10){return _0x122c06(_0xd25c10);},'JlRUo':function(_0x129f10,_0x378b08){return _0x129f10(_0x378b08);},'CbkbJ':function(_0x527a2c,_0x2aaed2){return _0x527a2c(_0x2aaed2);},'HJceJ':function(_0x3eeaad,_0x347eff){return _0x3eeaad(_0x347eff);}},_0x328420=_0x2d4676[_0xf13379(0x21d,'W0%A')](ObjectKeys2LowerCase,$request[_0xf13379(0x202,'z5h(')]);let _0x287c1f='SM';_0x2d4676[_0xf13379(0x1dc,'uz$0')](output,_0xf13379(0x1c3,'HQlP')+_0x287c1f);const _0x66f019=await _0x2d4676['CbkbJ'](RefreshToken,_0x287c1f);_0x2d4676['HJceJ'](output,_0xf13379(0x247,'3ge$')+_0x66f019),Object[_0xf13379(0x211,'TqNj')](_0x328420,{'authorization':_0xf13379(0x1e9,'dLSk')+_0x66f019}),$[_0xf13379(0x1bb,'FM2#')]({'headers':_0x328420});},ModifyResp=async()=>{const _0x50320d=_0x5cb350,_0x32f677={'ECzft':function(_0x4daaa6,_0x3f415d){return _0x4daaa6(_0x3f415d);},'rYiUO':function(_0x5997e1,_0x5e91f8){return _0x5997e1===_0x5e91f8;},'cbHJS':_0x50320d(0x21b,'8Vpj'),'xTPdP':function(_0x2b9f7a,_0x187942){return _0x2b9f7a===_0x187942;},'ncvIf':_0x50320d(0x1b6,'eo3@'),'hKFAj':_0x50320d(0x24d,'5XTe'),'iLPDj':_0x50320d(0x1d7,'^2]W'),'gJstz':'永久会员','DTEFr':'2099-11-18','XOeHk':function(_0x3f283c,_0x5d13f1){return _0x3f283c(_0x5d13f1);}};console['log']($response?.[_0x50320d(0x1fd,'Pzx[')]);let _0x2d77bd=JSON[_0x50320d(0x1cc,'FM2#')]($response?.['body']||'{}');_0x32f677[_0x50320d(0x1be,'dLSk')](output,_0x50320d(0x1ba,'OGSp')+$['toObj'](_0x2d77bd));let {sign:_0x2e4ced,data:_0x5a0b21}=await _0x32f677[_0x50320d(0x243,'uz$0')](DecryptResp,_0x2d77bd);console[_0x50320d(0x208,'^JHG')]($[_0x50320d(0x24a,'eo3@')]({'sign':_0x2e4ced,'decrypted':_0x5a0b21}));if(_0x5a0b21[_0x50320d(0x1bd,'dLSk')]!=='0'){if(_0x32f677[_0x50320d(0x22e,'8Vpj')](_0x32f677['cbHJS'],_0x32f677[_0x50320d(0x1a6,'pAU2')]))$['log']('','❗️'+$[_0x50320d(0x24c,'zS0S')]+',\x20错误!',statusMessages[_0x5a0b21[_0x50320d(0x232,'E@!y')]]||'未知错误'),$['done']({'body':$[_0x50320d(0x234,'3ge$')]({'obj':_0x2d77bd})});else{const _0x4456a3={'kGPOw':function(_0x3eba82,_0x413c10){return _0x3eba82(_0x413c10);}};return new _0x21f7cb((_0x1fef66,_0x1ff393)=>{const _0x2cdf78=_0x50320d,_0x4d8a27={'sKOlY':function(_0x2ace3b,_0x1b5bd1){const _0x48ba98=_0x22b4;return _0x4456a3[_0x48ba98(0x1b4,'hDh2')](_0x2ace3b,_0x1b5bd1);}};_0x24372d[_0x2cdf78(0x20a,'Xib0')]({'url':_0x16d69d+'/api/series6/encrypt','headers':{'Content-Type':_0x2cdf78(0x20c,'^sCE')},'body':_0x15740f[_0x2cdf78(0x19a,'3ge$')]({'yh':_0x31986a})},(_0xe1a209,_0x7e8eeb,_0x1f6688)=>{const _0x337256=_0x2cdf78;if(_0xe1a209)_0x4d8a27['sKOlY'](_0x1ff393,_0xe1a209);else{const {success:_0x1f4621,data:_0x4ac60d,message:_0x5b8e28}=_0x165344[_0x337256(0x1af,'8RrF')](_0x1f6688);_0x1f4621?_0x4d8a27['sKOlY'](_0x1fef66,_0x4ac60d):_0x1ff393(_0x5b8e28);}});});}}/users\/get_profile/[_0x50320d(0x1a1,'uz$0')]($request[_0x50320d(0x1e4,'W0%A')])&&(_0x32f677[_0x50320d(0x1b9,'O^Y7')](_0x32f677[_0x50320d(0x1cd,'pg3O')],_0x32f677['ncvIf'])?(_0x5a0b21[_0x50320d(0x1c6,'7HdD')]['nickname']=_0x32f677[_0x50320d(0x20d,'9g@T')],_0x5a0b21[_0x50320d(0x21e,'INo%')]['avatar']=_0x32f677[_0x50320d(0x1ca,'Xib0')],_0x5a0b21[_0x50320d(0x1b5,'W0%A')]['balance']=_0x50320d(0x1db,'Pzx['),_0x5a0b21['data'][_0x50320d(0x1d5,'3GnO')]=0x1,_0x5a0b21[_0x50320d(0x1f4,'zcPl')][_0x50320d(0x22f,'dLSk')]=!![],_0x5a0b21['data'][_0x50320d(0x1ef,'8RrF')]=_0x32f677[_0x50320d(0x19f,'8RrF')],_0x5a0b21['data'][_0x50320d(0x19d,'4agN')]=0x1,_0x5a0b21[_0x50320d(0x1e0,'8Vpj')][_0x50320d(0x1f3,'eo3@')]=_0x32f677[_0x50320d(0x1e8,'Kc@r')],_0x5a0b21['data'][_0x50320d(0x1f7,'rOCh')]=0x3e7,_0x5a0b21['data'][_0x50320d(0x1f0,'TqNj')]=0x3e7,_0x5a0b21[_0x50320d(0x1fe,'MZ9y')][_0x50320d(0x204,'$Kyv')]=0x3e7):_0x199d53['data']=[]);/banners/[_0x50320d(0x1dd,'AzPf')]($request[_0x50320d(0x240,'8Vpj')])&&(_0x5a0b21[_0x50320d(0x21c,'Xib0')]=[]);let _0x569107=await EncryptReq({'sign':_0x2e4ced,'data':_0x5a0b21});_0x32f677['XOeHk'](output,_0x50320d(0x238,'Kc@r')+_0x569107),$[_0x50320d(0x1a8,'*Axl')]({'body':JSON['stringify']({'sign':_0x2d77bd[_0x50320d(0x1fa,'^2]W')],'responseData':_0x569107})});};function RefreshToken(_0xcacff8){const _0x5db1c5=_0x5cb350,_0x3f8808={'KawIc':function(_0x1982ff,_0x1c6313){return _0x1982ff+_0x1c6313;},'FrIus':function(_0x12b028,_0xe3b101){return _0x12b028*_0xe3b101;},'dQRmd':function(_0xebdde7,_0x1b253d){return _0xebdde7-_0x1b253d;},'bRKoU':function(_0x1dff39,_0x5e21bc){return _0x1dff39<_0x5e21bc;},'SSQLF':function(_0x216d91,_0x233639){return _0x216d91*_0x233639;},'QUBbg':function(_0x4b1635,_0x4953fe){return _0x4b1635-_0x4953fe;},'SwJAF':function(_0x540722,_0x37ff94){return _0x540722(_0x37ff94);},'yZufH':_0x5db1c5(0x1d0,'MP&Q'),'SnDOD':function(_0x16223d,_0x54157c){return _0x16223d(_0x54157c);},'zcKYW':function(_0x76a129,_0x2ab7e1){return _0x76a129===_0x2ab7e1;},'TNjLl':'application/json','uxyzs':_0x5db1c5(0x24b,'uz$0'),'XhiZr':function(_0x130f92,_0x1638ca,_0xff5726){return _0x130f92(_0x1638ca,_0xff5726);}},_0x446b81=function(_0x128e48,_0x4d222d,_0x6884bb){const _0x373e19=_0x5db1c5;var _0xc1c484='',_0x11a283=_0x4d222d,_0x4737d6=['0','1','2','3','4','5','6','7','8','9','a','b','c','d','e','f','g','h','i','j','k','l','m','n','o','p','q','r','s','t','u','v','w','x','y','z','A','B','C','D','E','F','G','H','I','J','K','L','M','N','O','P','Q','R','S','T','U','V','W','X','Y','Z'];_0x128e48&&(_0x11a283=_0x3f8808[_0x373e19(0x1a4,'PiCL')](Math['round'](_0x3f8808[_0x373e19(0x223,'zcPl')](Math['random'](),_0x3f8808[_0x373e19(0x215,'FM2#')](_0x6884bb,_0x4d222d))),_0x4d222d));for(var _0xa08923=0x0;_0x3f8808['bRKoU'](_0xa08923,_0x11a283);_0xa08923++){var _0x555907=Math[_0x373e19(0x1cf,'^sCE')](_0x3f8808[_0x373e19(0x221,'eo3@')](Math[_0x373e19(0x209,'MP&Q')](),_0x3f8808[_0x373e19(0x1b2,'PiCL')](_0x4737d6[_0x373e19(0x1f6,'ZB@a')],0x1)));_0xc1c484+=_0x4737d6[_0x555907];}return _0xc1c484;};return new Promise((_0x19ccf7,_0x1d204a)=>{const _0x323dc4=_0x5db1c5,_0x32fc71={'VfMiQ':function(_0x43d1ee,_0x21d62e){return _0x43d1ee(_0x21d62e);},'NZdFr':function(_0x4cb43d,_0x49d8c4){const _0x306ce0=_0x22b4;return _0x3f8808[_0x306ce0(0x218,'hDh2')](_0x4cb43d,_0x49d8c4);},'tfEyn':function(_0x51e18e,_0x4a36eb){return _0x51e18e!==_0x4a36eb;},'aSfRc':_0x3f8808['yZufH'],'KImjU':function(_0x218639,_0x1e38e7){const _0x442938=_0x22b4;return _0x3f8808[_0x442938(0x252,'$N)M')](_0x218639,_0x1e38e7);},'RJmXM':function(_0x239874,_0x3e7fd7){return _0x3f8808['zcKYW'](_0x239874,_0x3e7fd7);}};$[_0x323dc4(0x1ce,'HQlP')]({'url':domain+'/api/auth/auto_login','headers':{'Accept':_0x3f8808['TNjLl'],'Origin':''+domain,'Host':host,'Content-Type':_0x3f8808[_0x323dc4(0x1ea,'E@!y')],'x-app-name':'SM','x-antv-client':_0x323dc4(0x1c7,'QJhm'),'User-Agent':_0x3f8808[_0x323dc4(0x21a,'7HdD')]},'body':JSON[_0x323dc4(0x1d9,'V$vr')]({'imei':_0x3f8808['XhiZr'](_0x446b81,!0x1,0x20)})},async(_0x5c3f68,_0x5414cc,_0x3a09be)=>{const _0x3494a3=_0x323dc4;if(_0x32fc71['tfEyn'](_0x32fc71[_0x3494a3(0x1e6,'Pzx[')],_0x32fc71['aSfRc'])){const {success:_0x587ab6,data:_0x3b5ba3,message:_0x210c99}=_0x3c8691[_0x3494a3(0x1f8,'4agN')](_0x40b4ac);_0x587ab6?_0x5b266f(_0x3b5ba3):_0x32fc71[_0x3494a3(0x1d6,'Pzx[')](_0x2bb80c,_0x210c99);}else{if(_0x5c3f68)_0x32fc71[_0x3494a3(0x1c2,'z5h(')](_0x1d204a,_0x5c3f68);else{if(_0x32fc71['RJmXM']('EhAFq',_0x3494a3(0x21f,'9g@T'))){const {success:_0x4cc955,data:_0x31cbab,message:_0xacfa88}=_0x3b1277[_0x3494a3(0x23c,'PiCL')](_0x44e7b7);_0x4cc955?_0x32fc71[_0x3494a3(0x214,'MP&Q')](_0x5c1ccf,_0x31cbab):_0x3db1ef(_0xacfa88);}else{const {data:{code:_0x366bf2,message:_0x10ae63,data:_0x336ebc}}=await _0x32fc71['KImjU'](DecryptResp,JSON[_0x3494a3(0x246,'ZB@a')](_0x3a09be));output(_0x3494a3(0x1df,'n(@*')+_0x366bf2+_0x3494a3(0x20b,'[P2n')+_0x10ae63+',\x20data:\x20'+JSON['stringify'](_0x336ebc)),'0'===_0x366bf2?_0x32fc71[_0x3494a3(0x227,'hDh2')](_0x19ccf7,_0x336ebc[_0x3494a3(0x22c,'OGSp')]):_0x1d204a(statusMessages[_0x366bf2]||_0x10ae63);}}}});});}function DecryptResp(_0x496c99){const _0x1454f3=_0x5cb350,_0x2b8078={'Csetu':function(_0x1c9b76,_0x26a8fa){return _0x1c9b76(_0x26a8fa);},'oeCFT':function(_0x33ad18,_0x261bd1){return _0x33ad18(_0x261bd1);},'Bmvbf':_0x1454f3(0x1a9,'^JHG'),'UfHou':function(_0x57bd21,_0x1096ff){return _0x57bd21(_0x1096ff);},'KGEZI':function(_0x407510,_0x286b99){return _0x407510!==_0x286b99;},'dAzhn':_0x1454f3(0x231,'TqNj'),'pjUtV':function(_0x10dd1b,_0x5964b8){return _0x10dd1b(_0x5964b8);},'VkUTt':'5|8|0|7|6|1|10|3|2|4|9','zVIKd':'999.99','rRyNY':'https://avatars.githubusercontent.com/u/50571734?s=120&u=9626b891a9e3fb3f73e38fb2f9d9583a2d78e9fe&v=4','BITsf':function(_0x3ca737,_0x5b3e82){return _0x3ca737(_0x5b3e82);},'wRCRM':'nHmas','STyWq':_0x1454f3(0x20f,'V$vr'),'XdMUD':_0x1454f3(0x1b3,'Xib0')};return new Promise((_0x417114,_0x56db2d)=>{const _0x586c2d=_0x1454f3,_0x3790aa={'KSYib':function(_0x27ccdd,_0x59e400){return _0x2b8078['BITsf'](_0x27ccdd,_0x59e400);}};if(_0x2b8078[_0x586c2d(0x22d,'^2]W')]!==_0x2b8078['STyWq'])$[_0x586c2d(0x1a3,'QJhm')]({'url':server+_0x586c2d(0x1eb,'Xib0'),'headers':{'Content-Type':_0x2b8078[_0x586c2d(0x210,'ZSNr')]},'body':JSON[_0x586c2d(0x1bc,'zS0S')]({'yh':_0x496c99})},(_0x54b57e,_0x2db7fd,_0x3bf440)=>{const _0x122e41=_0x586c2d,_0x3f6115={'fwRmp':function(_0x514593,_0x3cfa47){const _0x8ce526=_0x22b4;return _0x2b8078[_0x8ce526(0x248,'^2]W')](_0x514593,_0x3cfa47);},'tNDrn':function(_0x1a0c33,_0x195d1e){const _0x17958d=_0x22b4;return _0x2b8078[_0x17958d(0x24f,'V$vr')](_0x1a0c33,_0x195d1e);}};if(_0x2b8078[_0x122e41(0x1d4,'ZSNr')]===_0x122e41(0x212,'^2]W')){if(_0x4f9e5a)_0x24f58d(_0x43f74b);else{const {success:_0x12b31c,data:_0x3f5dfc,message:_0x22c48e}=_0x55410e['parse'](_0xe3144c);_0x12b31c?_0x3790aa[_0x122e41(0x253,'INo%')](_0x16027c,_0x3f5dfc):_0x418d30(_0x22c48e);}}else{if(_0x54b57e)_0x2b8078['UfHou'](_0x56db2d,_0x54b57e);else{if(_0x2b8078['KGEZI'](_0x2b8078['dAzhn'],'xungz')){const {success:_0xfc8bc6,data:_0x298654,message:_0x4f8aee}=JSON[_0x122e41(0x1d2,'QJhm')](_0x3bf440);_0xfc8bc6?_0x2b8078['pjUtV'](_0x417114,_0x298654):_0x56db2d(_0x4f8aee);}else{if(_0x514aba)_0x3f6115[_0x122e41(0x1b8,'$N)M')](_0x5552f8,_0x17e84c);else{const {success:_0x2e2d4e,data:_0x3717f3,message:_0x2828a4}=_0x15c5c3[_0x122e41(0x225,'O^Y7')](_0x152dd8);_0x2e2d4e?_0x3f6115[_0x122e41(0x1da,'^2]W')](_0x39e107,_0x3717f3):_0x422989(_0x2828a4);}}}}});else{const _0x95b96f=_0x2b8078[_0x586c2d(0x1c5,'eo3@')]['split']('|');let _0x5dc100=0x0;while(!![]){switch(_0x95b96f[_0x5dc100++]){case'0':_0x23a266[_0x586c2d(0x219,'MP&Q')]['balance']=_0x2b8078[_0x586c2d(0x241,'CoA]')];continue;case'1':_0x25543c[_0x586c2d(0x230,'eo3@')][_0x586c2d(0x251,'TqNj')]=_0x586c2d(0x239,'PiCL');continue;case'2':_0xe4e4cb[_0x586c2d(0x1e0,'8Vpj')][_0x586c2d(0x254,'QJhm')]=0x3e7;continue;case'3':_0x5c2ef1[_0x586c2d(0x1c4,'4agN')][_0x586c2d(0x217,'8Vpj')]=_0x586c2d(0x1ff,'$Kyv');continue;case'4':_0x1b5417[_0x586c2d(0x1ac,'dLSk')]['tickets']=0x3e7;continue;case'5':_0x3d8306[_0x586c2d(0x1ec,'ZB@a')][_0x586c2d(0x1fc,'z5h(')]=_0x586c2d(0x237,'9g@T');continue;case'6':_0x170fda[_0x586c2d(0x249,'QJhm')][_0x586c2d(0x23a,'ZB@a')]=!![];continue;case'7':_0x233fd8[_0x586c2d(0x201,'Lv)M')][_0x586c2d(0x207,'efT)')]=0x1;continue;case'8':_0x51d83e[_0x586c2d(0x236,'Kc@r')]['avatar']=_0x2b8078[_0x586c2d(0x19c,'HQlP')];continue;case'9':_0x4735cc[_0x586c2d(0x1b5,'W0%A')][_0x586c2d(0x1f5,'[P2n')]=0x3e7;continue;case'10':_0x57ba99[_0x586c2d(0x1e5,'^2]W')][_0x586c2d(0x1c9,'[P2n')]=0x1;continue;}break;}}});}function EncryptReq(_0x3b0acc){const _0x2cd011={'ZYjAx':function(_0x3c3867,_0x28d703){return _0x3c3867(_0x28d703);},'iFtCk':function(_0x431f5f,_0x4a247b){return _0x431f5f===_0x4a247b;},'hHhIg':'nwrkM','okCWH':'PIBkn','fWBWA':function(_0xb198dd,_0x400942){return _0xb198dd(_0x400942);},'eHFBF':function(_0x5d588c,_0x39be48){return _0x5d588c(_0x39be48);},'pLKCT':'application/json'};return new Promise((_0x3cd94d,_0x364fd4)=>{const _0x2d7d2e=_0x22b4;$[_0x2d7d2e(0x222,'^JHG')]({'url':server+_0x2d7d2e(0x23d,'HQlP'),'headers':{'Content-Type':_0x2cd011[_0x2d7d2e(0x24e,'ZSNr')]},'body':JSON[_0x2d7d2e(0x226,'MP&Q')]({'yh':_0x3b0acc})},(_0x1ea0e4,_0x4f6ef5,_0x51f765)=>{const _0x35b62a=_0x2d7d2e,_0x5c35d6={'YBLZv':function(_0x3b9a7d,_0x22d5d0){const _0x1f1b88=_0x22b4;return _0x2cd011[_0x1f1b88(0x229,'E@!y')](_0x3b9a7d,_0x22d5d0);},'rgdho':function(_0x721095,_0x50391e){return _0x721095(_0x50391e);}};if(_0x2cd011[_0x35b62a(0x1c0,'3ge$')](_0x2cd011[_0x35b62a(0x205,'W0%A')],_0x2cd011[_0x35b62a(0x1d3,'9g@T')]))_0x17b0d4[_0x35b62a(0x200,'CoA]')]({'url':_0x1bcfe3+'/api/series6/encrypt','headers':{'Content-Type':_0x35b62a(0x242,'eo3@')},'body':_0x2faaeb[_0x35b62a(0x1f2,'^sCE')]({'yh':_0x21586f})},(_0x21a609,_0x484b49,_0x5a326d)=>{if(_0x21a609)_0x5c35d6['YBLZv'](_0x11a9f7,_0x21a609);else{const {success:_0x33adfc,data:_0x2c128f,message:_0x223f46}=_0x4fbf87['parse'](_0x5a326d);_0x33adfc?_0x5c35d6['rgdho'](_0x57703d,_0x2c128f):_0x6a50b2(_0x223f46);}});else{if(_0x1ea0e4)_0x2cd011[_0x35b62a(0x1d1,'zS0S')](_0x364fd4,_0x1ea0e4);else{const {success:_0x46be51,data:_0x258233,message:_0x59f9a4}=JSON['parse'](_0x51f765);_0x46be51?_0x2cd011[_0x35b62a(0x206,'ZB@a')](_0x3cd94d,_0x258233):_0x2cd011[_0x35b62a(0x1e7,'5XTe')](_0x364fd4,_0x59f9a4);}}});});};(async()=>{const _0x53f266=_0x5cb350,_0xb7f674={'btgyf':function(_0xbc8768,_0x43446c){return _0xbc8768(_0x43446c);},'XydDX':'KEgOI','EbRey':function(_0x25d060){return _0x25d060();}};if(/videos(\/\w+|)\/show/[_0x53f266(0x1bf,'pAU2')]($request[_0x53f266(0x1a5,'E@!y')]))await ModifyReq();else{if($response?.[_0x53f266(0x1ed,'zcPl')]){if(_0x53f266(0x1b1,'Pzx[')!==_0xb7f674['XydDX'])return new _0x34f655((_0x593cf7,_0x2ea3b9)=>{const _0x1e371a=_0x53f266,_0x4e4ad7={'fyqAz':function(_0x571a82,_0x4021ce){const _0xf8ca37=_0x22b4;return _0xb7f674[_0xf8ca37(0x1ab,'QJhm')](_0x571a82,_0x4021ce);},'uecuA':function(_0x1ab5e8,_0xf4e382){const _0x53221c=_0x22b4;return _0xb7f674[_0x53221c(0x1e1,'HQlP')](_0x1ab5e8,_0xf4e382);},'NHRDq':function(_0x646f90,_0x46a3f2){const _0x1f4bf3=_0x22b4;return _0xb7f674[_0x1f4bf3(0x224,'*Axl')](_0x646f90,_0x46a3f2);}};_0xb9b2c0[_0x1e371a(0x1ee,'E@!y')]({'url':_0x177143+'/api/series6/decrypt','headers':{'Content-Type':_0x1e371a(0x213,'CoA]')},'body':_0x4db9fc[_0x1e371a(0x1f2,'^sCE')]({'yh':_0x3d36fe})},(_0x4bd40b,_0x45e865,_0x14d857)=>{const _0x5f1958=_0x1e371a;if(_0x4bd40b)_0x4e4ad7[_0x5f1958(0x228,'5XTe')](_0x2ea3b9,_0x4bd40b);else{const {success:_0x4a55ed,data:_0x2164f8,message:_0x35b69d}=_0x7b1b0a['parse'](_0x14d857);_0x4a55ed?_0x4e4ad7[_0x5f1958(0x22b,'ZSNr')](_0x593cf7,_0x2164f8):_0x4e4ad7[_0x5f1958(0x233,'eo3@')](_0x2ea3b9,_0x35b69d);}});});else await _0xb7f674[_0x53f266(0x245,'[P2n')](ModifyResp);}else $[_0x53f266(0x23e,'V$vr')]({});}})()[_0x5cb350(0x220,'z5h(')](_0x2d8104=>$[_0x5cb350(0x1b0,'9g@T')](_0x2d8104));function ObjectKeys2LowerCase(_0x17b48c){const _0x1f3767=_0x5cb350;let _0x4edee1={};for(let _0x4284d8 in _0x17b48c){_0x4edee1[_0x4284d8[_0x1f3767(0x1e2,'$N)M')]()]=_0x17b48c[_0x4284d8];}return _0x4edee1;}function output(..._0x4101e6){debug&&console['log']([..._0x4101e6]['join']('\x0a'));}var version_ = 'jsjiami.com.v7';
// prettier-ignore
function Env(t,e){class s{constructor(t){this.env=t}send(t,e="GET"){t="string"==typeof t?{url:t}:t;let s=this.get;return"POST"===e&&(s=this.post),new Promise((e,a)=>{s.call(this,t,(t,s,r)=>{t?a(t):e(s)})})}get(t){return this.send.call(this.env,t)}post(t){return this.send.call(this.env,t,"POST")}}return new class{constructor(t,e){this.name=t,this.http=new s(this),this.data=null,this.dataFile="box.dat",this.logs=[],this.isMute=!1,this.isNeedRewrite=!1,this.logSeparator="\n",this.encoding="utf-8",this.startTime=(new Date).getTime(),Object.assign(this,e),this.log("",`🔔${this.name}, 开始!`)}getEnv(){return"undefined"!=typeof $environment&&$environment["surge-version"]?"Surge":"undefined"!=typeof $environment&&$environment["stash-version"]?"Stash":"undefined"!=typeof module&&module.exports?"Node.js":"undefined"!=typeof $task?"Quantumult X":"undefined"!=typeof $loon?"Loon":"undefined"!=typeof $rocket?"Shadowrocket":void 0}isNode(){return"Node.js"===this.getEnv()}isQuanX(){return"Quantumult X"===this.getEnv()}isSurge(){return"Surge"===this.getEnv()}isLoon(){return"Loon"===this.getEnv()}isShadowrocket(){return"Shadowrocket"===this.getEnv()}isStash(){return"Stash"===this.getEnv()}toObj(t,e=null){try{return JSON.parse(t)}catch{return e}}toStr(t,e=null){try{return JSON.stringify(t)}catch{return e}}getjson(t,e){let s=e;const a=this.getdata(t);if(a)try{s=JSON.parse(this.getdata(t))}catch{}return s}setjson(t,e){try{return this.setdata(JSON.stringify(t),e)}catch{return!1}}getScript(t){return new Promise(e=>{this.get({url:t},(t,s,a)=>e(a))})}runScript(t,e){return new Promise(s=>{let a=this.getdata("@chavy_boxjs_userCfgs.httpapi");a=a?a.replace(/\n/g,"").trim():a;let r=this.getdata("@chavy_boxjs_userCfgs.httpapi_timeout");r=r?1*r:20,r=e&&e.timeout?e.timeout:r;const[i,o]=a.split("@"),n={url:`http://${o}/v1/scripting/evaluate`,body:{script_text:t,mock_type:"cron",timeout:r},headers:{"X-Key":i,Accept:"*/*"},timeout:r};this.post(n,(t,e,a)=>s(a))}).catch(t=>this.logErr(t))}loaddata(){if(!this.isNode())return{};{this.fs=this.fs?this.fs:require("fs"),this.path=this.path?this.path:require("path");const t=this.path.resolve(this.dataFile),e=this.path.resolve(process.cwd(),this.dataFile),s=this.fs.existsSync(t),a=!s&&this.fs.existsSync(e);if(!s&&!a)return{};{const a=s?t:e;try{return JSON.parse(this.fs.readFileSync(a))}catch(t){return{}}}}}writedata(){if(this.isNode()){this.fs=this.fs?this.fs:require("fs"),this.path=this.path?this.path:require("path");const t=this.path.resolve(this.dataFile),e=this.path.resolve(process.cwd(),this.dataFile),s=this.fs.existsSync(t),a=!s&&this.fs.existsSync(e),r=JSON.stringify(this.data);s?this.fs.writeFileSync(t,r):a?this.fs.writeFileSync(e,r):this.fs.writeFileSync(t,r)}}lodash_get(t,e,s){const a=e.replace(/\[(\d+)\]/g,".$1").split(".");let r=t;for(const t of a)if(r=Object(r)[t],void 0===r)return s;return r}lodash_set(t,e,s){return Object(t)!==t?t:(Array.isArray(e)||(e=e.toString().match(/[^.[\]]+/g)||[]),e.slice(0,-1).reduce((t,s,a)=>Object(t[s])===t[s]?t[s]:t[s]=Math.abs(e[a+1])>>0==+e[a+1]?[]:{},t)[e[e.length-1]]=s,t)}getdata(t){let e=this.getval(t);if(/^@/.test(t)){const[,s,a]=/^@(.*?)\.(.*?)$/.exec(t),r=s?this.getval(s):"";if(r)try{const t=JSON.parse(r);e=t?this.lodash_get(t,a,""):e}catch(t){e=""}}return e}setdata(t,e){let s=!1;if(/^@/.test(e)){const[,a,r]=/^@(.*?)\.(.*?)$/.exec(e),i=this.getval(a),o=a?"null"===i?null:i||"{}":"{}";try{const e=JSON.parse(o);this.lodash_set(e,r,t),s=this.setval(JSON.stringify(e),a)}catch(e){const i={};this.lodash_set(i,r,t),s=this.setval(JSON.stringify(i),a)}}else s=this.setval(t,e);return s}getval(t){switch(this.getEnv()){case"Surge":case"Loon":case"Stash":case"Shadowrocket":return $persistentStore.read(t);case"Quantumult X":return $prefs.valueForKey(t);case"Node.js":return this.data=this.loaddata(),this.data[t];default:return this.data&&this.data[t]||null}}setval(t,e){switch(this.getEnv()){case"Surge":case"Loon":case"Stash":case"Shadowrocket":return $persistentStore.write(t,e);case"Quantumult X":return $prefs.setValueForKey(t,e);case"Node.js":return this.data=this.loaddata(),this.data[e]=t,this.writedata(),!0;default:return this.data&&this.data[e]||null}}initGotEnv(t){this.got=this.got?this.got:require("got"),this.cktough=this.cktough?this.cktough:require("tough-cookie"),this.ckjar=this.ckjar?this.ckjar:new this.cktough.CookieJar,t&&(t.headers=t.headers?t.headers:{},void 0===t.headers.Cookie&&void 0===t.cookieJar&&(t.cookieJar=this.ckjar))}get(t,e=(()=>{})){switch(t.headers&&(delete t.headers["Content-Type"],delete t.headers["Content-Length"],delete t.headers["content-type"],delete t.headers["content-length"]),t.params&&(t.url+="?"+this.queryStr(t.params)),this.getEnv()){case"Surge":case"Loon":case"Stash":case"Shadowrocket":default:this.isSurge()&&this.isNeedRewrite&&(t.headers=t.headers||{},Object.assign(t.headers,{"X-Surge-Skip-Scripting":!1})),$httpClient.get(t,(t,s,a)=>{!t&&s&&(s.body=a,s.statusCode=s.status?s.status:s.statusCode,s.status=s.statusCode),e(t,s,a)});break;case"Quantumult X":this.isNeedRewrite&&(t.opts=t.opts||{},Object.assign(t.opts,{hints:!1})),$task.fetch(t).then(t=>{const{statusCode:s,statusCode:a,headers:r,body:i,bodyBytes:o}=t;e(null,{status:s,statusCode:a,headers:r,body:i,bodyBytes:o},i,o)},t=>e(t&&t.error||"UndefinedError"));break;case"Node.js":let s=require("iconv-lite");this.initGotEnv(t),this.got(t).on("redirect",(t,e)=>{try{if(t.headers["set-cookie"]){const s=t.headers["set-cookie"].map(this.cktough.Cookie.parse).toString();s&&this.ckjar.setCookieSync(s,null),e.cookieJar=this.ckjar}}catch(t){this.logErr(t)}}).then(t=>{const{statusCode:a,statusCode:r,headers:i,rawBody:o}=t,n=s.decode(o,this.encoding);e(null,{status:a,statusCode:r,headers:i,rawBody:o,body:n},n)},t=>{const{message:a,response:r}=t;e(a,r,r&&s.decode(r.rawBody,this.encoding))})}}post(t,e=(()=>{})){const s=t.method?t.method.toLocaleLowerCase():"post";switch(t.body&&t.headers&&!t.headers["Content-Type"]&&!t.headers["content-type"]&&(t.headers["content-type"]="application/x-www-form-urlencoded"),t.headers&&(delete t.headers["Content-Length"],delete t.headers["content-length"]),this.getEnv()){case"Surge":case"Loon":case"Stash":case"Shadowrocket":default:this.isSurge()&&this.isNeedRewrite&&(t.headers=t.headers||{},Object.assign(t.headers,{"X-Surge-Skip-Scripting":!1})),$httpClient[s](t,(t,s,a)=>{!t&&s&&(s.body=a,s.statusCode=s.status?s.status:s.statusCode,s.status=s.statusCode),e(t,s,a)});break;case"Quantumult X":t.method=s,this.isNeedRewrite&&(t.opts=t.opts||{},Object.assign(t.opts,{hints:!1})),$task.fetch(t).then(t=>{const{statusCode:s,statusCode:a,headers:r,body:i,bodyBytes:o}=t;e(null,{status:s,statusCode:a,headers:r,body:i,bodyBytes:o},i,o)},t=>e(t&&t.error||"UndefinedError"));break;case"Node.js":let a=require("iconv-lite");this.initGotEnv(t);const{url:r,...i}=t;this.got[s](r,i).then(t=>{const{statusCode:s,statusCode:r,headers:i,rawBody:o}=t,n=a.decode(o,this.encoding);e(null,{status:s,statusCode:r,headers:i,rawBody:o,body:n},n)},t=>{const{message:s,response:r}=t;e(s,r,r&&a.decode(r.rawBody,this.encoding))})}}time(t,e=null){const s=e?new Date(e):new Date;let a={"M+":s.getMonth()+1,"d+":s.getDate(),"H+":s.getHours(),"m+":s.getMinutes(),"s+":s.getSeconds(),"q+":Math.floor((s.getMonth()+3)/3),S:s.getMilliseconds()};/(y+)/.test(t)&&(t=t.replace(RegExp.$1,(s.getFullYear()+"").substr(4-RegExp.$1.length)));for(let e in a)new RegExp("("+e+")").test(t)&&(t=t.replace(RegExp.$1,1==RegExp.$1.length?a[e]:("00"+a[e]).substr((""+a[e]).length)));return t}queryStr(t){let e="";for(const s in t){let a=t[s];null!=a&&""!==a&&("object"==typeof a&&(a=JSON.stringify(a)),e+=`${s}=${a}&`)}return e=e.substring(0,e.length-1),e}msg(e=t,s="",a="",r){const i=t=>{switch(typeof t){case void 0:return t;case"string":switch(this.getEnv()){case"Surge":case"Stash":default:return{url:t};case"Loon":case"Shadowrocket":return t;case"Quantumult X":return{"open-url":t};case"Node.js":return}case"object":switch(this.getEnv()){case"Surge":case"Stash":case"Shadowrocket":default:{let e=t.url||t.openUrl||t["open-url"];return{url:e}}case"Loon":{let e=t.openUrl||t.url||t["open-url"],s=t.mediaUrl||t["media-url"];return{openUrl:e,mediaUrl:s}}case"Quantumult X":{let e=t["open-url"]||t.url||t.openUrl,s=t["media-url"]||t.mediaUrl,a=t["update-pasteboard"]||t.updatePasteboard;return{"open-url":e,"media-url":s,"update-pasteboard":a}}case"Node.js":return}default:return}};if(!this.isMute)switch(this.getEnv()){case"Surge":case"Loon":case"Stash":case"Shadowrocket":default:$notification.post(e,s,a,i(r));break;case"Quantumult X":$notify(e,s,a,i(r));break;case"Node.js":}if(!this.isMuteLog){let t=["","==============📣系统通知📣=============="];t.push(e),s&&t.push(s),a&&t.push(a),console.log(t.join("\n")),this.logs=this.logs.concat(t)}}log(...t){t.length>0&&(this.logs=[...this.logs,...t]),console.log(t.join(this.logSeparator))}logErr(t,e){switch(this.getEnv()){case"Surge":case"Loon":case"Stash":case"Shadowrocket":case"Quantumult X":default:this.log("",`❗️${this.name}, 错误!`,t);break;case"Node.js":this.log("",`❗️${this.name}, 错误!`,t.stack)}}wait(t){return new Promise(e=>setTimeout(e,t))}done(t={}){const e=(new Date).getTime(),s=(e-this.startTime)/1e3;switch(this.log("",`🔔${this.name}, 结束! 🕛 ${s} 秒`),this.log(),this.getEnv()){case"Surge":case"Loon":case"Stash":case"Shadowrocket":case"Quantumult X":default:$done(t);break;case"Node.js":process.exit(1)}}}(t,e)}
